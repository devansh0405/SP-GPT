<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>YouTube Video Summarizer & Query</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
  <div class="container mx-auto mt-20 p-8 max-w-2xl bg-white rounded-2xl shadow-lg">
    <h1 class="text-3xl font-bold text-center mb-6">üé¨ YouTube Video Summarizer & Query</h1>

    <!-- YouTube URL Input -->
    <div class="mb-4">
      <label for="youtube_url" class="block text-lg font-semibold mb-2">YouTube URL (optional):</label>
      <input id="youtube_url" type="text" placeholder="Enter YouTube video URL" class="w-full border border-gray-300 rounded-lg px-4 py-2">
    </div>

    <!-- Query Input -->
    <div class="mb-4">
      <label for="query" class="block text-lg font-semibold mb-2">Your Question or Instruction:</label>
      <textarea id="query" rows="3" placeholder="E.g., 'Summarize the main points of the video'" class="w-full border border-gray-300 rounded-lg px-4 py-2"></textarea>
    </div>

    <div class="flex justify-between mb-6">
      <button id="get_id_btn" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition">Get Video ID</button>
      <button id="summarize_btn" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition">Submit Query</button>
    </div>

    <div id="result" class="bg-gray-50 p-4 rounded-lg hidden">
      <h2 class="text-xl font-semibold mb-2">Result:</h2>
      <pre id="output" class="whitespace-pre-wrap"></pre>
    </div>
  </div>

  <script>
    const getIdBtn = document.getElementById('get_id_btn');
    const summarizeBtn = document.getElementById('summarize_btn');
    const youtubeUrlInput = document.getElementById('youtube_url');
    const queryInput = document.getElementById('query');
    const resultDiv = document.getElementById('result');
    const output = document.getElementById('output');

    async function postData(url = '', data = {}) {
      const response = await fetch(url, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(data)
      });
      return response.json();
    }

    getIdBtn.addEventListener('click', async () => {
      const youtube_url = youtubeUrlInput.value.trim();
      if (!youtube_url) return alert('Please enter a YouTube URL.');

      const res = await postData('/get_video_id', { youtube_url });
      resultDiv.classList.remove('hidden');

      if (res.error) output.textContent = '‚ùå Error: ' + res.error;
      else output.textContent = 'üé• Video ID: ' + res.video_id;
    });

    summarizeBtn.addEventListener('click', async () => {
      const youtube_url = youtubeUrlInput.value.trim();
      const query = queryInput.value.trim();

      if (!query) return alert('Please enter a query or question.');

      output.textContent = '‚è≥ Processing... Please wait.';
      resultDiv.classList.remove('hidden');

      const res = await postData('/summarize', { youtube_url, query });

      if (res.error) output.textContent = '‚ùå Error: ' + res.error;
      else output.textContent = 'üßæ Answer:\n\n' + res.response;
    });
  </script>
</body>
</html>
